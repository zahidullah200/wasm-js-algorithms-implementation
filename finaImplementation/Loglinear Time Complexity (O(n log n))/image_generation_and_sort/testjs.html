<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sort Image Data</title>
</head>
<body>
<h1>Sort Image Data</h1>
<button id="sortButton">Sort Image Data</button>
<div style="display:flex">
  <canvas id="originalCanvas" width="100" height="100" style="border:1px solid black;"></canvas>
  <canvas id="sortedCanvas" width="100" height="100" style="border:1px solid black;"></canvas>
</div>
<p id="time_taken"></p>
<p id="time_complexity"></p>
<script>
  // Struct to represent a pixel (RGBA)
  class Pixel {
      constructor(r, g, b, a) {
          this.r = r;
          this.g = g;
          this.b = b;
          this.a = a;
      }
  }

  // Function to calculate grayscale value of a pixel
  function calculateGrayscale(pixel) {
      return Math.round(0.3 * pixel.r + 0.59 * pixel.g + 0.11 * pixel.b);
  }

  // Function declarations
  function partition(arr, left, right) {
      const pivot = arr[right];
      let i = left - 1;

      for (let j = left; j < right; j++) {
          if (calculateGrayscale(arr[j]) <= calculateGrayscale(pivot)) {
              i++;
              const temp = arr[i];
              arr[i] = arr[j];
              arr[j] = temp;
          }
      }

      const temp = arr[i + 1];
      arr[i + 1] = arr[right];
      arr[right] = temp;

      return i + 1;
  }

  function quickSort(arr, left, right) {
      if (left < right) {
          const pivotIndex = partition(arr, left, right);
          quickSort(arr, left, pivotIndex - 1);
          quickSort(arr, pivotIndex + 1, right);
      }
  }

  // Function to generate random pixel value
  function randomPixel() {
      return new Pixel(
          Math.floor(Math.random() * 256),
          Math.floor(Math.random() * 256),
          Math.floor(Math.random() * 256),
          255
      );
  }

  // Function to generate random image data
  function generateImageData(width, height) {
      const size = width * height;
      const imageData = new Array(size);
      for (let i = 0; i < size; i++) {
          imageData[i] = randomPixel();
      }
      return imageData;
  }

  // Function to display image data on canvas
  function displayImageData(canvasId, imageData, width, height) {
      const canvas = document.getElementById(canvasId);
      const ctx = canvas.getContext('2d');
      const imageDataArray = ctx.createImageData(width, height);
      for (let i = 0; i < imageData.length; i++) {
          const index = i * 4;
          imageDataArray.data[index] = imageData[i].r;
          imageDataArray.data[index + 1] = imageData[i].g;
          imageDataArray.data[index + 2] = imageData[i].b;
          imageDataArray.data[index + 3] = imageData[i].a;
      }
      ctx.putImageData(imageDataArray, 0, 0);
  }

  // Test button click
  document.getElementById("sortButton").addEventListener("click", function() {
      const width = 100;
      const height = 100;
      const originalImageData = generateImageData(width, height);
      const sortedImageData = originalImageData.slice(); // Copy original image data

      const startTime = performance.now(); // Start measuring performance time
      quickSort(sortedImageData, 0, sortedImageData.length - 1);
      const endTime = performance.now(); // End measuring performance time
      const elapsedTime = endTime - startTime;

      displayImageData("originalCanvas", originalImageData, width, height);
      displayImageData("sortedCanvas", sortedImageData, width, height);

      document.getElementById("time_taken").textContent = `Performance Time: ${elapsedTime.toFixed(2)} ms`;

      // Time complexity
      const n = width * height;
      const timeComplexity = `Time Complexity: O(n log n)`;
      document.getElementById("time_complexity").textContent = timeComplexity;
  });
</script>
</body>
</html>
